(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dc1bc302"],{"0e23":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAwCAYAAABuZUjcAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACQSURBVHgB7dZBCsIwFEXRhytwh307zxLqDrRBB6JGaEr/T+AeeNBRuWT0JQAAkGPZtm4rr+8p1ND721ZN4DO6rmhwv6LrrIERHYXoKERHITpKKzpqRZ03T5FSw//ePBe1XZXvpg5W/mtbndz46aIJWMTnsIjPYRGfwyI+h7XjxhiN9X3ZTcN6Bh+6MQAAwBkenfri+dnMU94AAAAASUVORK5CYII="},"5fc7":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tweet-main"},[s("Navbar"),s("div",{staticClass:"tweet"},[s("div",{staticClass:"tweet__header"},[s("img",{staticClass:"tweet__header__back",attrs:{src:a("0e23"),alt:""},on:{click:function(t){return e.$router.back()}}}),s("div",{staticClass:"tweet__header__content"},[e._v("推文")])]),s("div",{staticClass:"tweet__container"},[s("div",{staticClass:"tweet__container__user-info"},[s("router-link",{staticClass:"tweet__container__user-info__user-avatar",attrs:{to:{name:"sub-profile",params:{id:e.userTweet.UserId}}}},[e.user.avatar?s("img",{staticClass:"user-avatar",attrs:{src:e.user.avatar?e.user.avatar:" ",alt:""}}):e._e()]),s("div",{staticClass:"tweet__container__user-info__wrapper"},[s("router-link",{staticClass:"tweet__container__user-info__wrapper--name",attrs:{to:{name:"sub-profile",params:{id:e.userTweet.UserId}}}},[e._v(e._s(e.user.name))]),s("router-link",{staticClass:"tweet__container__user-info__wrapper--account",attrs:{to:{name:"sub-profile",params:{id:e.userTweet.UserId}}}},[e._v(e._s("@"+e.user.account))])],1)],1),s("div",{staticClass:"tweet__container__content"},[e._v(" "+e._s(e.userTweet.description)+" ")]),s("div",{staticClass:"tweet__container__time"},[e._v(" "+e._s(e._f("fullTime")(e.userTweet.createdAt))+" ")]),s("div",{staticClass:"tweet__container__numbers"},[s("div",{staticClass:"tweet__container__numbers__reply"},[s("span",{staticClass:"tweet__container__numbers__reply--counts"},[e._v(e._s(e.userTweet.repliesCount))]),s("span",{staticClass:"tweet__container__numbers__reply--words"},[e._v("回覆")])]),s("div",{staticClass:"tweet__container__numbers__like"},[s("span",{staticClass:"tweet__container__numbers__like--counts"},[e._v(e._s(e.userTweet.likesCount))]),s("span",{staticClass:"tweet__container__numbers__like--words"},[e._v("喜歡次數")])])]),s("div",{staticClass:"tweet__container__icons"},[s("img",{staticClass:"tweets__container__icons__comment",attrs:{src:a("5845"),alt:"","data-toggle":"modal","data-target":"#tweet-"+e.userTweet.id},on:{click:function(t){return e.handleClick(e.userTweet)}}}),e.userTweet.isLiked?e._e():s("img",{staticClass:"tweets__container__icons__like",attrs:{src:a("c20a"),alt:""},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addLike(e.userTweet.id)}}}),e.userTweet.isLiked?s("img",{staticClass:"tweets__container__icons__like",attrs:{src:a("e6bf"),alt:""},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteLike(e.userTweet.id)}}}):e._e()])]),s("div",{staticClass:"modal fade",attrs:{id:"tweet-"+e.userTweet.id,tabindex:"-1","aria-labelledby":"replyModal","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog"},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"modal-header"},[s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:e.handleCancel}},[s("span",{staticClass:"close--text",attrs:{"aria-hidden":"true"}},[e._v("×")])])]),s("div",{staticClass:"modal-body"},[s("div",{staticClass:"modal-body__tweet"},[s("div",{staticClass:"modal-body__tweet__user-avatar"},[e.userTweet.User.avatar?s("img",{staticClass:"avatar",attrs:{src:e.userTweet.User.avatar?e.userTweet.User.avatar:"",alt:""}}):e._e()]),s("div",{staticClass:"modal-body__tweet__content"},[s("div",{staticClass:"modal-body__tweet__content__info"},[s("div",{staticClass:"modal-body__tweet__content__info--name"},[e._v(" "+e._s(e.userTweet.User.name)+" ")]),s("div",{staticClass:"modal-body__tweet__content__info--account"},[e._v(" "+e._s("@"+e.userTweet.User.account)+" ")]),s("div",{staticClass:"modal-body__tweet__content__info--time"},[e._v(" "+e._s(e._f("fromNow")(e.userTweet.createdAt))+" ")])]),s("div",{staticClass:"modal-body__tweet__content__text"},[e._v(" "+e._s(e.userTweet.description)+" ")]),s("div",{staticClass:"modal-body__tweet__content__reply-to"},[s("div",{staticClass:"modal-body__tweet__content__reply-to--reply"},[e._v(" 回覆給 ")]),s("div",{staticClass:"modal-body__tweet__content__reply-to--account"},[e._v(" "+e._s("@"+e.userTweet.User.account)+" ")])])])]),s("div",{staticClass:"modal-body__reply"},[s("div",{staticClass:"modal-body__reply__user-avatar"},[e.currentUser.avatar?s("img",{staticClass:"avatar",attrs:{src:e.currentUser.avatar?e.currentUser.avatar:"",alt:""}}):e._e()]),s("form",{staticClass:"reply",attrs:{action:""}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.reply,expression:"reply"}],attrs:{placeholder:"推你的回覆",name:"reply-textarea",id:"reply-textarea",cols:"50",rows:"4"},domProps:{value:e.reply},on:{input:function(t){t.target.composing||(e.reply=t.target.value)}}})])])]),s("div",{staticClass:"modal-footer",class:{error:e.reply.length>140,reply_error:e.error&&0===e.reply.length}},[e.reply.length>0&&e.reply.length<=140?s("button",{staticClass:"btn-modal button",attrs:{"data-dismiss":"modal"},on:{click:function(t){return e.handleSubmit(e.tweetModal.id)}}},[e._v(" 回覆 ")]):e._e(),0===e.reply.length||e.reply.length>140?s("button",{staticClass:"btn-modal button",on:{click:function(t){return e.handleSubmit()}}},[e._v(" 回覆 ")]):e._e()])])])]),s("Comments",{attrs:{"initial-replies":e.replies,"user-tweet":e.userTweet}})],1),s("PopularUsers")],1)},r=[],n=a("1da1"),i=a("5530"),c=(a("96cf"),a("d9e2"),a("d178")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.replies,(function(t){return a("div",{key:t.id,staticClass:"comments"},[a("router-link",{staticClass:"comments__user-avatar",attrs:{to:{name:"sub-profile",params:{id:t.UserId}}}},[a("img",{staticClass:"comments__user-avatar--img",attrs:{src:"",alt:""}})]),a("div",{staticClass:"comments__container"},[a("div",{staticClass:"comments__container__info"},[a("router-link",{staticClass:"comments__container__info--name",attrs:{to:{name:"sub-profile",params:{id:t.UserId}}}},[e._v(" "+e._s(t.User.name)+" ")]),a("router-link",{staticClass:"comments__container__info--account",attrs:{to:{name:"sub-profile",params:{id:t.UserId}}}},[e._v(" "+e._s("@"+t.User.account)+" ")]),a("div",{staticClass:"comments__container__info--time"},[e._v(" ・ "+e._s(e._f("fromNow")(t.createdAt))+" ")])],1),a("div",{staticClass:"comments__container__reply-to"},[a("div",{staticClass:"comments__container__reply-to--reply"},[e._v("回覆")]),a("router-link",{staticClass:"comments__container__reply-to--account",attrs:{to:{name:"sub-profile",params:{id:e.userTweet.UserId}}}},[e._v(" "+e._s("@"+e.userTweet.User.account)+" ")])],1),a("div",{staticClass:"comments__container__text"},[e._v(e._s(t.comment))])])],1)})),0)},l=[],_=a("2708"),u={name:"Comments",props:{initialReplies:{type:Array,required:!0},userTweet:{type:Object,required:!0}},mixins:[_["a"]],data:function(){return{replies:[]}},methods:{fetchReplies:function(){this.replies=this.initialReplies}},created:function(){this.fetchReplies()},watch:{initialReplies:function(e){this.replies=e}}},d=u,m=(a("979a"),a("2877")),p=Object(m["a"])(d,o,l,!1,null,"40ba18cc",null),w=p.exports,v=a("f963"),f=a("6783"),b=a("2fa3"),C=a("2f62"),h={name:"IndividualTweet",components:{Navbar:c["a"],Comments:w,PopularUsers:v["a"]},mixins:[_["a"]],data:function(){return{userTweet:{},user:{},replies:[],tweetModal:[],reply:"",error:!1}},computed:Object(i["a"])({},Object(C["b"])(["currentUser"])),methods:{fetchTweet:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,f["a"].getIndividualTweet({tweetId:e});case 3:if(s=a.sent,200===s.status){a.next=6;break}throw new Error(s.statusText);case 6:t.userTweet=s.data,t.user=s.data.User,t.user=Object(i["a"])(Object(i["a"])({},t.user),{},{avatar:t.user.avatar?t.user.avatar:""}),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](0),b["a"].fire({icon:"error",title:"無法取得推文資料，請稍後再試"});case 14:case"end":return a.stop()}}),a,null,[[0,11]])})))()},fetchReplies:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,f["a"].getReplies({tweetId:e});case 3:if(s=a.sent,200===s.status){a.next=6;break}throw new Error(s.data.statusText);case 6:t.replies=s.data,a.next=13;break;case 9:a.prev=9,a.t0=a["catch"](0),console.log(a.t0),b["a"].fire({icon:"error",title:"無法取得回覆，請稍後再試"});case 13:case"end":return a.stop()}}),a,null,[[0,9]])})))()},addLike:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,f["a"].addLike({tweetId:e});case 3:if(s=a.sent,"success"===s.data.status){a.next=6;break}throw new Error(s.statusText);case 6:t.userTweet=Object(i["a"])(Object(i["a"])({},t.userTweet),{},{isLiked:!0,likesCount:t.userTweet.likesCount+1}),a.next=13;break;case 9:a.prev=9,a.t0=a["catch"](0),console.log(a.t0),b["a"].fire({icon:"error",title:"無法按讚推文，請稍後再試"});case 13:case"end":return a.stop()}}),a,null,[[0,9]])})))()},deleteLike:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,f["a"].deleteLike({tweetId:e});case 3:if(s=a.sent,"success"===s.data.status){a.next=6;break}throw new Error(s.data.statusText);case 6:t.userTweet=Object(i["a"])(Object(i["a"])({},t.userTweet),{},{isLiked:!1,likesCount:t.userTweet.likesCount-1}),a.next=13;break;case 9:a.prev=9,a.t0=a["catch"](0),console.log(a.t0),b["a"].fire({icon:"error",title:"無法取消按讚推文，請稍後再試"});case 13:case"end":return a.stop()}}),a,null,[[0,9]])})))()},handleClick:function(e){this.tweetModal=e},handleCancel:function(){this.reply=""},handleSubmit:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,t.reply){a.next=4;break}return t.error=!0,a.abrupt("return");case 4:if(!(t.reply.length>140)){a.next=6;break}return a.abrupt("return");case 6:return a.next=8,f["a"].reply({tweetId:e,comment:t.reply});case 8:if(s=a.sent,r=s.data,"success"===r.status){a.next=12;break}throw new Error(r.message);case 12:t.reply="",t.error=!1,t.fetchTweet(e),t.fetchReplies(e),a.next=24;break;case 18:a.prev=18,a.t0=a["catch"](0),console.log(a.t0),t.reply="",t.error=!1,b["a"].fire({icon:"error",title:"無法新增回覆，請稍後再試"});case 24:case"end":return a.stop()}}),a,null,[[0,18]])})))()}},created:function(){var e=this.$route.params.tweet_id;this.fetchTweet(e),this.fetchReplies(e)}},k=h,y=(a("cd31"),Object(m["a"])(k,s,r,!1,null,"693c67e2",null));t["default"]=y.exports},"725c":function(e,t,a){},"979a":function(e,t,a){"use strict";a("725c")},b667:function(e,t,a){},cd31:function(e,t,a){"use strict";a("b667")}}]);
//# sourceMappingURL=chunk-dc1bc302.275d30aa.js.map