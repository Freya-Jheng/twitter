{"version":3,"sources":["webpack:///./src/views/Setting.vue?6097","webpack:///./src/views/Setting.vue?032e","webpack:///src/views/Setting.vue","webpack:///./src/views/Setting.vue?4d6b","webpack:///./src/views/Setting.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","on","$event","stopPropagation","preventDefault","handleSubmit","apply","arguments","directives","name","rawName","value","user","expression","attrs","domProps","target","composing","$set","class","error","length","error_input","error_color","_s","_f","remaining","isProcessing","staticRenderFns","data","id","account","email","password","checkPassword","computed","mapState","components","Navbar","created","fetchUser","methods","currentUser","Toast","icon","title","usersAPI","userId","response","filters","remainingFilter","component"],"mappings":"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","file":"js/chunk-0f17482c.cca8b479.js","sourcesContent":["export * from \"-!../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Setting.vue?vue&type=style&index=0&id=7df82354&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-setting\"},[_c('Navbar'),_c('div',{staticClass:\"setting\"},[_c('div',{staticClass:\"setting__title\"},[_vm._v(\"帳號設定\")]),_c('form',{staticClass:\"setting__form\",on:{\"submit\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.handleSubmit.apply(null, arguments)}}},[_c('div',{staticClass:\"setting__form__item account at\"},[_c('label',{staticClass:\"setting__form__item-title\"},[_vm._v(\"帳號\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.user.account),expression:\"user.account\"}],staticClass:\"setting__form__item-input account-input\",attrs:{\"type\":\"text\",\"name\":\"account\",\"id\":\"account\"},domProps:{\"value\":(_vm.user.account)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.user, \"account\", $event.target.value)}}})]),_c('div',{staticClass:\"setting__form__item name\",class:{ error: _vm.user.name.length > 50 }},[_c('label',{staticClass:\"setting__form__item-title\"},[_vm._v(\"名稱\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.user.name),expression:\"user.name\"}],staticClass:\"setting__form__item-input name\",class:{ error_input: _vm.user.name.length > 50 },attrs:{\"type\":\"text\",\"name\":\"name\",\"id\":\"name\"},domProps:{\"value\":(_vm.user.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.user, \"name\", $event.target.value)}}}),_c('span',{staticClass:\"remaining\",class:{ error_color: _vm.user.name.length > 50 }},[_vm._v(_vm._s(_vm._f(\"remainingFilter\")(_vm.remaining))+\" / 50\")])]),_c('div',{staticClass:\"setting__form__item email\"},[_c('label',{staticClass:\"setting__form__item-title\"},[_vm._v(\"Email\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.user.email),expression:\"user.email\"}],staticClass:\"setting__form__item-input\",attrs:{\"type\":\"email\",\"name\":\"email\",\"id\":\"email\"},domProps:{\"value\":(_vm.user.email)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.user, \"email\", $event.target.value)}}})]),_c('div',{staticClass:\"setting__form__item password\"},[_c('label',{staticClass:\"setting__form__item-title\"},[_vm._v(\"密碼\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.user.password),expression:\"user.password\"}],staticClass:\"setting__form__item-input\",attrs:{\"type\":\"password\",\"name\":\"password\",\"id\":\"password\"},domProps:{\"value\":(_vm.user.password)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.user, \"password\", $event.target.value)}}})]),_c('div',{staticClass:\"setting__form__item passwordChecked\"},[_c('label',{staticClass:\"setting__form__item-title\"},[_vm._v(\"密碼確認\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.user.checkPassword),expression:\"user.checkPassword\"}],staticClass:\"setting__form__item-input\",attrs:{\"type\":\"password\",\"name\":\"passwordChecked\",\"id\":\"passwordChecked\"},domProps:{\"value\":(_vm.user.checkPassword)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.user, \"checkPassword\", $event.target.value)}}})]),_c('button',{staticClass:\"setting__save btn\",attrs:{\"disabled\":_vm.isProcessing || _vm.user.name.length > 50,\"type\":\"submit\"}},[_vm._v(\" \"+_vm._s(_vm.isProcessing ? '修改中' : '儲存')+\" \")])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"main-setting\">\n    <Navbar />\n    <div class=\"setting\">\n      <div class=\"setting__title\">帳號設定</div>\n      <form @submit.stop.prevent=\"handleSubmit\" class=\"setting__form\">\n        <div class=\"setting__form__item account at\">\n          <label class=\"setting__form__item-title\">帳號</label>\n          <input\n            type=\"text\"\n            name=\"account\"\n            class=\"setting__form__item-input account-input\"\n            id=\"account\"\n            v-model=\"user.account\"\n          />\n        </div>\n        <div\n          class=\"setting__form__item name\"\n          :class=\"{ error: user.name.length > 50 }\"\n        >\n          <label class=\"setting__form__item-title\">名稱</label>\n          <input\n            type=\"text\"\n            name=\"name\"\n            class=\"setting__form__item-input name\"\n            id=\"name\"\n            v-model=\"user.name\"\n            :class=\"{ error_input: user.name.length > 50 }\"\n          />\n          <span\n            class=\"remaining\"\n            :class=\"{ error_color: user.name.length > 50 }\"\n            >{{ remaining | remainingFilter }} / 50</span\n          >\n        </div>\n        <div class=\"setting__form__item email\">\n          <label class=\"setting__form__item-title\">Email</label>\n          <input\n            type=\"email\"\n            name=\"email\"\n            class=\"setting__form__item-input\"\n            id=\"email\"\n            v-model=\"user.email\"\n          />\n        </div>\n        <div class=\"setting__form__item password\">\n          <label class=\"setting__form__item-title\">密碼</label>\n          <input\n            type=\"password\"\n            name=\"password\"\n            class=\"setting__form__item-input\"\n            id=\"password\"\n            v-model=\"user.password\"\n          />\n        </div>\n        <div class=\"setting__form__item passwordChecked\">\n          <label class=\"setting__form__item-title\">密碼確認</label>\n          <input\n            type=\"password\"\n            name=\"passwordChecked\"\n            class=\"setting__form__item-input\"\n            id=\"passwordChecked\"\n            v-model=\"user.checkPassword\"\n          />\n        </div>\n        <button\n          :disabled=\"isProcessing || user.name.length > 50\"\n          type=\"submit\"\n          class=\"setting__save btn\"\n        >\n          {{ isProcessing ? '修改中' : '儲存' }}\n        </button>\n      </form>\n    </div>\n  </div>\n</template>\n<script>\nimport Navbar from '../components/Navbar.vue'\nimport { mapState } from 'vuex'\nimport { Toast } from '../utils/helpers'\nimport usersAPI from './../apis/users'\n\nexport default {\n  name: 'Setting',\n  data() {\n    return {\n      user: {\n        id: -1,\n        account: '',\n        name: '',\n        email: '',\n        password: '',\n        checkPassword: '',\n      },\n      isProcessing: false,\n    }\n  },\n  computed: {\n    ...mapState(['currentUser']),\n    remaining() {\n      return 50 - this.user.name.length ? 50 - this.user.name.length : 0\n    },\n  },\n  components: {\n    Navbar,\n  },\n  created() {\n    this.fetchUser()\n  },\n  methods: {\n    fetchUser() {\n      this.user.id = this.currentUser.id\n      this.user.account = this.currentUser.account\n      this.user.name = this.currentUser.name\n      this.user.email = this.currentUser.email\n      this.user.password = this.currentUser.password\n      this.user.checkPassword = this.currentUser.checkPassword\n    },\n    async handleSubmit() {\n      try {\n        if (!this.user.account) {\n          Toast.fire({\n            icon: 'warning',\n            title: '請輸入使用者帳號',\n          })\n          return\n        }\n\n        if (!this.user.name) {\n          Toast.fire({\n            icon: 'warning',\n            title: '請輸入使用者名稱',\n          })\n          return\n        }\n\n        if (!this.user.email) {\n          Toast.fire({\n            icon: 'warning',\n            title: '請輸入 email',\n          })\n          return\n        }\n\n        if (!this.user.password | !this.user.checkPassword) {\n          Toast.fire({\n            icon: 'warning',\n            title: '請輸入 password',\n          })\n          return\n        }\n\n        if (this.user.password !== this.user.checkPassword) {\n          Toast.fire({\n            icon: 'warning',\n            title: 'password 不一致',\n          })\n          return\n        }\n        const response = await usersAPI.update({\n          userId: this.user.id,\n          account: this.user.account,\n          email: this.user.email,\n          name: this.user.name,\n          password: this.user.password,\n          checkPassword: this.user.checkPassword,\n        })\n\n        if (response.status !== 200) {\n          throw new Error(response.statusText)\n        }\n        this.$store.dispatch('fetchCurrentUser')\n\n        Toast.fire({\n          icon: 'success',\n          title: '修改個人資料成功',\n        })\n\n        this.$router.push('/home')\n      } catch (error) {\n        if (\n          error.response.data.message === 'Error: Acount or Email repeated!'\n        ) {\n          Toast.fire({\n            icon: 'error',\n            title: '帳號或 email 重複，請重新輸入',\n          })\n        } else {\n          Toast.fire({\n            icon: 'error',\n            title: '無法修改個人資料，請稍後再試',\n          })\n        }\n      }\n    },\n  },\n  filters: {\n    remainingFilter: function (value) {\n      if (value < 0) {\n        return 0\n      }\n\n      return value\n    },\n  },\n}\n</script>\n\n<style scoped lang=\"scss\">\n.main-setting {\n  width: 100%;\n  display: grid;\n  grid-template-columns: 1fr 980px;\n  grid-template-rows: auto;\n  height: 100vh;\n  padding: 0 6%;\n\n  .setting {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    grid-column: 2/4;\n    font-size: 19px;\n    font-weight: 500;\n    border-left: 1px solid var(--border-and-divider);\n    .setting__title {\n      border-bottom: 1px solid var(--border-and-divider);\n      height: 55px;\n      width: 112%;\n      line-height: 55px;\n      font-size: 19px;\n      font-weight: 700;\n      padding-left: 20px;\n    }\n    form {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      width: 662px;\n      gap: 32px;\n      margin-top: 30px;\n      padding-left: 20px;\n      .setting__form__item {\n        width: 100%;\n        height: 52px;\n        background-color: var(--input-background);\n        display: flex;\n        flex-direction: column;\n        justify-content: flex-start;\n        .setting__form__item-title {\n          font-size: 15px;\n          line-height: 15px;\n          font-weight: 500;\n          color: var(--smaller-font-color);\n          padding: 5px 0 0 12px;\n          margin-bottom: 0;\n        }\n        input {\n          padding-top: 4px;\n          margin-top: 0;\n          width: 100%;\n          height: 32px;\n        }\n      }\n    }\n    .setting__save {\n      position: absolute;\n      top: 100%;\n      right: 0;\n      margin-top: 42px;\n      width: 116px;\n      height: 48px;\n      border-radius: 50px;\n      background-color: var(--button-background);\n      text-align: center;\n      font-size: 18px;\n      font-weight: bold;\n      color: var(--button-font);\n    }\n  }\n}\n\n.at:after {\n  position: absolute;\n  content: '@';\n  bottom: 4px;\n  left: 10px;\n}\n\n.account-input {\n  padding-left: 30px;\n}\n.name,\n.account {\n  position: relative;\n}\n\n.remaining {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  font-weight: 500;\n  font-size: 15px;\n  line-height: 15px;\n  color: var(--smaller-font-color);\n}\n.error {\n  position: relative;\n  &::after {\n    content: '字數超出上限';\n    position: absolute;\n    top: 55px;\n    left: 0px;\n    font-weight: 500;\n    font-size: 15px;\n    line-height: 15px;\n    color: var(--error-color);\n  }\n}\n\n.error_color {\n  color: var(--error-color);\n}\n\n.error_input {\n  border-bottom: 2px solid var(--error-color);\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Setting.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Setting.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Setting.vue?vue&type=template&id=7df82354&scoped=true&\"\nimport script from \"./Setting.vue?vue&type=script&lang=js&\"\nexport * from \"./Setting.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Setting.vue?vue&type=style&index=0&id=7df82354&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7df82354\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}